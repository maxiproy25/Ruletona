<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predictor Futurista de Ruleta Argentina</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #0f0c29;
            --secondary: #302b63;
            --accent: #00f7ff;
            --accent2: #ff00c8;
            --dark: #000;
            --light: #fff;
            --success: #00ff9d;
            --warning: #f9f871;
            --danger: #ff005c;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-hover: rgba(255, 255, 255, 0.2);
        }
        
        body {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--light);
            padding: 20px;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 30%, rgba(255, 0, 200, 0.1), transparent 70%),
                        radial-gradient(circle at 80% 70%, rgba(0, 247, 255, 0.1), transparent 70%);
            z-index: -1;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: rgba(10, 8, 40, 0.7);
            border-radius: 25px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            position: relative;
            overflow: hidden;
        }
        
        .container::after {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            z-index: -1;
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--accent);
            position: relative;
        }
        
        h1 {
            color: var(--accent);
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 0 0 15px var(--accent);
            letter-spacing: 1px;
            position: relative;
            display: inline-block;
        }
        
        h1::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--accent2);
            border-radius: 2px;
            box-shadow: 0 0 10px var(--accent2);
        }
        
        .input-section {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 25px 0;
        }
        
        input {
            flex-grow: 1;
            padding: 15px 20px;
            border-radius: 50px;
            border: 2px solid var(--glass-border);
            background: var(--glass);
            color: white;
            font-size: 1.1rem;
            min-width: 100px;
            text-align: center;
            transition: all 0.3s ease;
            outline: none;
        }
        
        input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 15px var(--accent);
        }
        
        input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .btn {
            background: linear-gradient(45deg, var(--accent), var(--accent2));
            color: var(--dark);
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 180px;
            position: relative;
            overflow: hidden;
            letter-spacing: 0.5px;
        }
        
        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 247, 255, 0.4), 0 0 15px rgba(255, 0, 200, 0.4);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .btn-success {
            background: linear-gradient(to right, var(--success), #00cc7a);
        }
        
        .btn-warning {
            background: linear-gradient(to right, var(--warning), #ffd600);
        }
        
        .btn-danger {
            background: linear-gradient(to right, var(--danger), #d50000);
        }
        
        .tabs {
            display: flex;
            justify-content: space-around;
            margin: 25px 0;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .tab-btn {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            color: white;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            margin: 5px;
            font-weight: 600;
            transition: all 0.3s;
            flex-grow: 1;
            text-align: center;
            min-width: 150px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
        }
        
        .tab-btn:hover {
            background: var(--glass-hover);
        }
        
        .tab-btn.active {
            background: linear-gradient(45deg, var(--accent), var(--accent2));
            color: var(--dark);
            box-shadow: 0 0 15px var(--accent);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
            margin-top: 20px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .prediction-display {
            background: rgba(0, 40, 40, 0.4);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
            border: 1px solid var(--accent);
            box-shadow: 0 0 30px rgba(0, 247, 255, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .prediction-display::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--accent), var(--accent2));
        }
        
        .prediction-number {
            font-size: 4rem;
            font-weight: bold;
            color: var(--accent);
            margin: 20px 0;
            text-shadow: 0 0 20px var(--accent);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); text-shadow: 0 0 20px var(--accent); }
            50% { transform: scale(1.05); text-shadow: 0 0 30px var(--accent); }
            100% { transform: scale(1); text-shadow: 0 0 20px var(--accent); }
        }
        
        .confidence {
            font-size: 1.4rem;
            margin: 10px 0;
            color: var(--accent2);
        }
        
        .history {
            background: var(--glass);
            border-radius: 20px;
            padding: 25px;
            margin: 25px 0;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid var(--glass-border);
        }
        
        .history-title {
            text-align: center;
            margin-bottom: 20px;
            color: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-size: 1.3rem;
        }
        
        .history-item {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid var(--glass-border);
            transition: background 0.3s;
            border-radius: 10px;
            margin: 5px 0;
        }
        
        .history-item:nth-child(even) {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .history-item:hover {
            background: rgba(0, 247, 255, 0.1);
        }
        
        .history-number {
            font-weight: bold;
            color: var(--accent);
            font-size: 1.2rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .stat-card {
            background: var(--glass);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(5px);
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 25px rgba(0, 247, 255, 0.2);
            border-color: var(--accent);
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--accent);
            margin: 10px 0;
            text-shadow: 0 0 10px var(--accent);
        }
        
        .stat-label {
            font-size: 1rem;
            opacity: 0.8;
            color: var(--accent2);
        }
        
        .progress-container {
            margin: 25px 0;
        }
        
        .progress-bar {
            height: 25px;
            background: var(--glass);
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid var(--glass-border);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            border-radius: 15px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px var(--accent);
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 1.1rem;
        }
        
        .chart-container {
            height: 250px;
            margin: 30px 0;
            background: var(--glass);
            border-radius: 20px;
            padding: 15px;
            border: 1px solid var(--glass-border);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--success);
            color: var(--dark);
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 15px;
            opacity: 0;
            transition: opacity 0.3s;
            font-weight: 600;
            backdrop-filter: blur(5px);
        }
        
        .notification.show {
            opacity: 1;
        }
        
        .notification.error {
            background: var(--danger);
            color: white;
        }
        
        .history-badge {
            background: var(--accent);
            color: var(--dark);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: bold;
            margin-left: 10px;
            box-shadow: 0 0 10px var(--accent);
        }
        
        .tutorial {
            background: var(--glass);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid var(--accent);
        }
        
        .tutorial h3 {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            color: var(--accent);
        }
        
        /* Slider Futurista */
        .slider-container {
            margin: 30px 0;
            position: relative;
            overflow: hidden;
            border-radius: 20px;
            height: 300px;
            border: 1px solid var(--glass-border);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }
        
        .slider {
            display: flex;
            transition: transform 0.5s ease-in-out;
            height: 100%;
        }
        
        .slide {
            min-width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 30px;
            text-align: center;
            background: rgba(20, 15, 60, 0.7);
            backdrop-filter: blur(5px);
        }
        
        .slide h3 {
            font-size: 2rem;
            color: var(--accent);
            margin-bottom: 20px;
            text-shadow: 0 0 15px var(--accent);
        }
        
        .slide p {
            font-size: 1.2rem;
            max-width: 800px;
            line-height: 1.6;
        }
        
        .slide-content {
            max-width: 700px;
            margin: 0 auto;
        }
        
        .slide-icon {
            font-size: 3rem;
            color: var(--accent2);
            margin-bottom: 20px;
            text-shadow: 0 0 15px var(--accent2);
        }
        
        .slider-nav {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;
        }
        
        .slider-dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .slider-dot.active {
            background: var(--accent);
            box-shadow: 0 0 10px var(--accent);
            transform: scale(1.2);
        }
        
        .slider-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: var(--glass);
            border: 1px solid var(--glass-border);
            color: var(--accent);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s;
        }
        
        .slider-btn:hover {
            background: var(--glass-hover);
            color: var(--accent2);
            box-shadow: 0 0 15px var(--accent);
        }
        
        .prev-btn {
            left: 20px;
        }
        
        .next-btn {
            right: 20px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @media (max-width: 768px) {
            .btn {
                width: 100%;
            }
            
            .prediction-number {
                font-size: 3rem;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .slider-container {
                height: 350px;
            }
        }
        
        @media (max-width: 480px) {
            .btn {
                padding: 12px 15px;
                font-size: 1rem;
            }
            
            .prediction-number {
                font-size: 2.5rem;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .input-section {
                flex-direction: column;
            }
            
            .slide h3 {
                font-size: 1.5rem;
            }
            
            .slide p {
                font-size: 1rem;
            }
            
            .slider-container {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-crystal-ball"></i> PREDICTOR FUTURISTA DE RULETA</h1>
            <p>Sistema de aprendizaje continuo con IA avanzada</p>
        </header>
        
        <!-- Slider Futurista -->
        <div class="slider-container">
            <div class="slider" id="slider">
                <div class="slide">
                    <div class="slide-content">
                        <div class="slide-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h3>Algoritmo de Predicción Avanzada</h3>
                        <p>Nuestro sistema utiliza aprendizaje automático para detectar patrones complejos en secuencias de números, mejorando su precisión con cada dato nuevo.</p>
                    </div>
                </div>
                <div class="slide">
                    <div class="slide-content">
                        <div class="slide-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3>Análisis Estadístico en Tiempo Real</h3>
                        <p>Visualiza frecuencias, patrones y tendencias con gráficos interactivos y estadísticas detalladas para tomar decisiones informadas.</p>
                    </div>
                </div>
                <div class="slide">
                    <div class="slide-content">
                        <div class="slide-icon">
                            <i class="fas fa-sync-alt"></i>
                        </div>
                        <h3>Retroalimentación Continua</h3>
                        <p>Cada predicción se compara con resultados reales, permitiendo que el sistema aprenda y mejore constantemente su precisión.</p>
                    </div>
                </div>
            </div>
            
            <div class="slider-btn prev-btn" id="prev-btn">
                <i class="fas fa-chevron-left"></i>
            </div>
            <div class="slider-btn next-btn" id="next-btn">
                <i class="fas fa-chevron-right"></i>
            </div>
            
            <div class="slider-nav" id="slider-nav">
                <div class="slider-dot active"></div>
                <div class="slider-dot"></div>
                <div class="slider-dot"></div>
            </div>
        </div>
        
        <div class="input-section">
            <input type="number" min="0" max="36" placeholder="Ingresa un número (0-36)" id="number-input">
            <button class="btn" id="add-btn"><i class="fas fa-plus"></i> Agregar número</button>
            <button class="btn btn-success" id="predict-btn"><i class="fas fa-crystal-ball"></i> Predecir próximo</button>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" data-tab="historial"><i class="fas fa-history"></i> Historial</button>
            <button class="tab-btn" data-tab="prediccion"><i class="fas fa-chart-line"></i> Predicción</button>
            <button class="tab-btn" data-tab="analisis"><i class="fas fa-chart-bar"></i> Análisis</button>
        </div>
        
        <!-- Pestaña Historial -->
        <div id="historial" class="tab-content active">
            <div class="history">
                <h3 class="history-title">
                    <i class="fas fa-list"></i> Números ingresados
                    <span class="history-badge" id="history-count">0</span>
                </h3>
                <div id="history-container"></div>
            </div>
            
            <div class="tutorial">
                <h3><i class="fas fa-lightbulb"></i> Instrucciones</h3>
                <p>1. Ingresa números manualmente (0-36) que hayan salido en la ruleta.</p>
                <p>2. Haz clic en "Predecir próximo" para obtener una estimación.</p>
                <p>3. Si la predicción no es correcta, ingresa el número real en el campo de arriba y haz clic en "Agregar número".</p>
                <p>4. El sistema aprenderá con cada nuevo dato y mejorará sus predicciones.</p>
            </div>
            
            <div class="controls" style="margin-top: 20px;">
                <button class="btn btn-danger" id="reset-btn"><i class="fas fa-trash-alt"></i> Reiniciar datos</button>
            </div>
        </div>
        
        <!-- Pestaña Predicción -->
        <div id="prediccion" class="tab-content">
            <div class="prediction-display">
                <h2><i class="fas fa-magic"></i> PRÓXIMA PREDICCIÓN</h2>
                <div class="prediction-number" id="prediction-number">--</div>
                <div class="confidence" id="confidence">Confianza: --</div>
            </div>
            
            <div class="feedback-section">
                <div class="input-section">
                    <input type="number" min="0" max="36" placeholder="Número real que salió" id="actual-input">
                    <button class="btn btn-warning" id="feedback-btn"><i class="fas fa-brain"></i> Aprender de este resultado</button>
                </div>
            </div>
            
            <div class="history">
                <h3 class="history-title">
                    <i class="fas fa-clipboard-list"></i> Historial de Predicciones
                    <span class="history-badge" id="prediction-count">0</span>
                </h3>
                <div id="prediction-history"></div>
            </div>
            
            <div class="progress-container">
                <h3><i class="fas fa-tachometer-alt"></i> Precisión del modelo</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="accuracy-bar" style="width: 0%"></div>
                </div>
                <div class="progress-label">
                    <span>0%</span>
                    <span id="accuracy-value">0%</span>
                    <span>100%</span>
                </div>
            </div>
        </div>
        
        <!-- Pestaña Análisis -->
        <div id="analisis" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="total-spins">0</div>
                    <div class="stat-label">Total de números</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="accuracy">0%</div>
                    <div class="stat-label">Precisión</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="vulnerability">0%</div>
                    <div class="stat-label">Vulnerabilidad</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="pattern-count">0</div>
                    <div class="stat-label">Patrones detectados</div>
                </div>
            </div>
            
            <div class="history">
                <h3 class="history-title">
                    <i class="fas fa-star"></i> Números más frecuentes
                    <span class="history-badge">5</span>
                </h3>
                <div id="frequent-numbers"></div>
            </div>
            
            <div class="chart-container">
                <canvas id="frequency-chart"></canvas>
            </div>
            
            <div class="tutorial">
                <h3><i class="fas fa-chart-line"></i> Evolución de la precisión</h3>
                <p>El sistema aprende con cada nuevo dato que ingresas. Cuantos más números agregues, más preciso será.</p>
                <p>Después de 30 números, el sistema comenzará a detectar patrones complejos.</p>
            </div>
        </div>
    </div>

    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">Operación completada</span>
    </div>

    <script>
        // Datos de la aplicación
        const appData = {
            history: [],
            predictions: [],
            trained: false,
            patterns: {},
            lastTrained: null,
            accuracyHistory: [],
            sequences: {}
        };
        
        // Elementos del DOM
        const elements = {
            numberInput: document.getElementById('number-input'),
            addBtn: document.getElementById('add-btn'),
            predictBtn: document.getElementById('predict-btn'),
            historyContainer: document.getElementById('history-container'),
            historyCount: document.getElementById('history-count'),
            predictionNumber: document.getElementById('prediction-number'),
            confidence: document.getElementById('confidence'),
            predictionHistory: document.getElementById('prediction-history'),
            predictionCount: document.getElementById('prediction-count'),
            totalSpins: document.getElementById('total-spins'),
            accuracy: document.getElementById('accuracy'),
            vulnerability: document.getElementById('vulnerability'),
            patternCount: document.getElementById('pattern-count'),
            frequentNumbers: document.getElementById('frequent-numbers'),
            accuracyBar: document.getElementById('accuracy-bar'),
            accuracyValue: document.getElementById('accuracy-value'),
            resetBtn: document.getElementById('reset-btn'),
            feedbackBtn: document.getElementById('feedback-btn'),
            actualInput: document.getElementById('actual-input'),
            notification: document.getElementById('notification'),
            notificationText: document.getElementById('notification-text'),
            slider: document.getElementById('slider'),
            prevBtn: document.getElementById('prev-btn'),
            nextBtn: document.getElementById('next-btn'),
            sliderNav: document.getElementById('slider-nav')
        };
        
        // Variables para el slider
        let currentSlide = 0;
        const slideCount = 3;
        let slideInterval;
        
        // Inicializar al cargar la página
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            initTabs();
            setupEventListeners();
            updateUI();
            initChart();
            initSlider();
            startSlider();
        });
        
        // Inicializar el slider
        function initSlider() {
            // Configurar navegación por puntos
            const dots = elements.sliderNav.querySelectorAll('.slider-dot');
            dots.forEach((dot, index) => {
                dot.addEventListener('click', () => {
                    goToSlide(index);
                });
            });
            
            // Botones de navegación
            elements.prevBtn.addEventListener('click', () => {
                prevSlide();
            });
            
            elements.nextBtn.addEventListener('click', () => {
                nextSlide();
            });
        }
        
        // Iniciar el auto-desplazamiento del slider
        function startSlider() {
            slideInterval = setInterval(() => {
                nextSlide();
            }, 5000);
        }
        
        // Ir a una slide específica
        function goToSlide(index) {
            currentSlide = index;
            updateSlider();
        }
        
        // Slide anterior
        function prevSlide() {
            currentSlide = (currentSlide - 1 + slideCount) % slideCount;
            updateSlider();
        }
        
        // Slide siguiente
        function nextSlide() {
            currentSlide = (currentSlide + 1) % slideCount;
            updateSlider();
        }
        
        // Actualizar el slider
        function updateSlider() {
            // Actualizar posición
            elements.slider.style.transform = `translateX(-${currentSlide * 100}%)`;
            
            // Actualizar puntos de navegación
            const dots = elements.sliderNav.querySelectorAll('.slider-dot');
            dots.forEach((dot, index) => {
                if (index === currentSlide) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });
            
            // Reiniciar el intervalo
            clearInterval(slideInterval);
            startSlider();
        }
        
        // Cargar datos guardados
        function loadData() {
            const savedData = localStorage.getItem('ruletaData');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                appData.history = parsedData.history || [];
                appData.predictions = parsedData.predictions || [];
                appData.trained = parsedData.trained || false;
                appData.patterns = parsedData.patterns || {};
                appData.lastTrained = parsedData.lastTrained || null;
                appData.accuracyHistory = parsedData.accuracyHistory || [];
                appData.sequences = parsedData.sequences || {};
            }
        }
        
        // Guardar datos
        function saveData() {
            localStorage.setItem('ruletaData', JSON.stringify(appData));
        }
        
        // Inicializar pestañas
        function initTabs() {
            const tabBtns = document.querySelectorAll('.tab-btn');
            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Remover clase activa de todas las pestañas
                    tabBtns.forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Agregar clase activa a la pestaña seleccionada
                    btn.classList.add('active');
                    document.getElementById(btn.dataset.tab).classList.add('active');
                });
            });
        }
        
        // Configurar listeners de eventos
        function setupEventListeners() {
            // Botón de agregar número
            elements.addBtn.addEventListener('click', addNumber);
            
            // Botón de predecir
            elements.predictBtn.addEventListener('click', predictNext);
            
            // Botón de reiniciar
            elements.resetBtn.addEventListener('click', resetData);
            
            // Botón de feedback
            elements.feedbackBtn.addEventListener('click', processFeedback);
            
            // Permitir agregar con Enter
            elements.numberInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addNumber();
            });
            
            elements.actualInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') processFeedback();
            });
        }
        
        // Mostrar notificación
        function showNotification(message, isError = false) {
            elements.notificationText.textContent = message;
            elements.notification.style.background = isError ? 'var(--danger)' : 'var(--success)';
            if (isError) {
                elements.notification.classList.add('error');
            } else {
                elements.notification.classList.remove('error');
            }
            elements.notification.classList.add('show');
            
            setTimeout(() => {
                elements.notification.classList.remove('show');
            }, 3000);
        }
        
        // Agregar número al historial
        function addNumber() {
            const number = parseInt(elements.numberInput.value);
            
            if (isNaN(number) || number < 0 || number > 36) {
                showNotification('Por favor ingresa un número válido entre 0 y 36', true);
                return;
            }
            
            // Agregar al historial
            appData.history.push(number);
            
            // Actualizar secuencias para aprendizaje
            updateSequences(number);
            
            saveData();
            updateUI();
            showNotification(`Número ${number} agregado correctamente`);
            
            elements.numberInput.value = '';
            elements.numberInput.focus();
        }
        
        // Actualizar secuencias para aprendizaje
        function updateSequences(newNumber) {
            const history = appData.history;
            const historyLength = history.length;
            
            if (historyLength < 2) return;
            
            // Actualizar secuencias de diferentes longitudes
            for (let seqLength = 2; seqLength <= 5; seqLength++) {
                if (historyLength >= seqLength) {
                    const start = historyLength - seqLength;
                    const sequence = history.slice(start, historyLength - 1).join(',');
                    const next = history[historyLength - 1];
                    
                    if (!appData.sequences[sequence]) {
                        appData.sequences[sequence] = {};
                    }
                    
                    if (!appData.sequences[sequence][next]) {
                        appData.sequences[sequence][next] = 1;
                    } else {
                        appData.sequences[sequence][next]++;
                    }
                }
            }
        }
        
        // Predecir próximo número
        function predictNext() {
            if (appData.history.length < 5) {
                showNotification('Necesitas al menos 5 números para hacer una predicción', true);
                return;
            }
            
            const history = appData.history;
            const historyLength = history.length;
            let prediction = null;
            let confidence = 0;
            
            // Intentar con diferentes longitudes de secuencia (de mayor a menor)
            for (let seqLength = 5; seqLength >= 2; seqLength--) {
                if (historyLength >= seqLength) {
                    const sequence = history.slice(historyLength - seqLength).join(',');
                    
                    if (appData.sequences[sequence]) {
                        let maxCount = 0;
                        let predictedNumber = null;
                        
                        // Encontrar el número más probable para esta secuencia
                        for (const [num, count] of Object.entries(appData.sequences[sequence])) {
                            if (count > maxCount) {
                                maxCount = count;
                                predictedNumber = parseInt(num);
                            }
                        }
                        
                        if (predictedNumber !== null) {
                            prediction = predictedNumber;
                            confidence = Math.min(0.95, maxCount / 10);
                            break;
                        }
                    }
                }
            }
            
            // Si no encontramos predicción, usar el número más frecuente
            if (prediction === null) {
                prediction = getMostFrequentNumber();
                confidence = 0.4;
            }
            
            // Guardar predicción temporal
            appData.currentPrediction = {
                predicted: prediction,
                confidence: confidence,
                timestamp: new Date().toISOString()
            };
            
            // Mostrar resultado
            elements.predictionNumber.textContent = prediction;
            elements.confidence.textContent = `Confianza: ${Math.round(confidence * 100)}%`;
            
            showNotification(`Predicción realizada: ${prediction}`);
        }
        
        // Obtener el número más frecuente
        function getMostFrequentNumber() {
            const counts = {};
            appData.history.forEach(num => {
                counts[num] = (counts[num] || 0) + 1;
            });
            
            let maxCount = 0;
            let mostFrequent = null;
            
            for (const [num, count] of Object.entries(counts)) {
                if (count > maxCount) {
                    maxCount = count;
                    mostFrequent = parseInt(num);
                }
            }
            
            return mostFrequent;
        }
        
        // Procesar feedback del usuario
        function processFeedback() {
            const actual = parseInt(elements.actualInput.value);
            
            if (isNaN(actual) || actual < 0 || actual > 36) {
                showNotification('Por favor ingresa un número válido entre 0 y 36', true);
                return;
            }
            
            // Agregar el número real al historial
            appData.history.push(actual);
            
            // Actualizar secuencias
            updateSequences(actual);
            
            // Guardar la predicción con resultado real
            if (appData.currentPrediction) {
                const prediction = appData.currentPrediction;
                prediction.actual = actual;
                prediction.isCorrect = (prediction.predicted === actual);
                appData.predictions.push(prediction);
                appData.currentPrediction = null;
                
                // Actualizar precisión
                updateAccuracy();
            }
            
            saveData();
            updateUI();
            showNotification(`Número ${actual} agregado y sistema actualizado`);
            
            elements.actualInput.value = '';
            elements.numberInput.focus();
        }
        
        // Actualizar precisión
        function updateAccuracy() {
            if (appData.predictions.length === 0) return;
            
            const lastPrediction = appData.predictions[appData.predictions.length - 1];
            const isCorrect = lastPrediction.isCorrect;
            
            if (isCorrect) {
                appData.accuracyHistory.push(1);
            } else {
                appData.accuracyHistory.push(0);
            }
            
            // Mantener solo los últimos 20 valores
            if (appData.accuracyHistory.length > 20) {
                appData.accuracyHistory.shift();
            }
            
            saveData();
        }
        
        // Reiniciar datos
        function resetData() {
            if (confirm('¿Estás seguro de reiniciar todos los datos? Se perderá toda la información.')) {
                appData.history = [];
                appData.predictions = [];
                appData.trained = false;
                appData.patterns = {};
                appData.lastTrained = null;
                appData.accuracyHistory = [];
                appData.sequences = {};
                appData.currentPrediction = null;
                saveData();
                updateUI();
                initChart();
                showNotification('Datos reiniciados correctamente');
            }
        }
        
        // Actualizar toda la UI
        function updateUI() {
            updateHistory();
            updatePredictionHistory();
            updateStats();
            updateChart();
        }
        
        // Actualizar historial de números
        function updateHistory() {
            const container = elements.historyContainer;
            container.innerHTML = '';
            elements.historyCount.textContent = appData.history.length;
            
            const start = Math.max(0, appData.history.length - 20);
            for (let i = start; i < appData.history.length; i++) {
                const item = document.createElement('div');
                item.className = 'history-item';
                item.innerHTML = `
                    <span>#${i + 1}</span>
                    <span class="history-number">${appData.history[i]}</span>
                `;
                container.appendChild(item);
            }
        }
        
        // Actualizar historial de predicciones
        function updatePredictionHistory() {
            const container = elements.predictionHistory;
            container.innerHTML = '';
            elements.predictionCount.textContent = appData.predictions.length;
            
            const start = Math.max(0, appData.predictions.length - 10);
            for (let i = start; i < appData.predictions.length; i++) {
                const pred = appData.predictions[i];
                const isCorrect = pred.isCorrect;
                
                const item = document.createElement('div');
                item.className = 'history-item';
                item.innerHTML = `
                    <span>Predicción: ${pred.predicted}</span>
                    <span>Real: ${pred.actual}</span>
                    <span style="color: ${isCorrect ? 'var(--success)' : 'var(--danger)'}">
                        <i class="fas ${isCorrect ? 'fa-check' : 'fa-times'}"></i>
                    </span>
                `;
                container.appendChild(item);
            }
        }
        
        // Actualizar estadísticas
        function updateStats() {
            // Total de números
            elements.totalSpins.textContent = appData.history.length;
            
            // Precisión
            let accuracy = 0;
            if (appData.predictions.length > 0) {
                const correct = appData.predictions.filter(p => p.isCorrect).length;
                accuracy = correct / appData.predictions.length;
            }
            elements.accuracy.textContent = `${Math.round(accuracy * 100)}%`;
            elements.accuracyBar.style.width = `${accuracy * 100}%`;
            elements.accuracyValue.textContent = `${Math.round(accuracy * 100)}%`;
            
            // Vulnerabilidad (simulada)
            const vulnerability = appData.history.length > 20 ? 
                Math.min(0.95, 0.3 + (appData.history.length / 100)) : 0;
            elements.vulnerability.textContent = `${Math.round(vulnerability * 100)}%`;
            
            // Patrones detectados
            const patternCount = Object.keys(appData.sequences).length;
            elements.patternCount.textContent = patternCount;
            
            // Números frecuentes
            updateFrequentNumbers();
        }
        
        // Actualizar números frecuentes
        function updateFrequentNumbers() {
            if (appData.history.length === 0) return;
            
            const counts = {};
            appData.history.forEach(num => {
                counts[num] = (counts[num] || 0) + 1;
            });
            
            // Ordenar por frecuencia
            const sorted = Object.entries(counts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
            
            const container = elements.frequentNumbers;
            container.innerHTML = '';
            
            sorted.forEach(([num, count]) => {
                const percentage = Math.round((count / appData.history.length) * 100);
                const item = document.createElement('div');
                item.className = 'history-item';
                item.innerHTML = `
                    <span>Número ${num}</span>
                    <span>${count} veces (${percentage}%)</span>
                `;
                container.appendChild(item);
            });
        }
        
        // Inicializar gráfico
        let frequencyChart;
        function initChart() {
            const ctx = document.getElementById('frequency-chart').getContext('2d');
            frequencyChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Array.from({length: 37}, (_, i) => i),
                    datasets: [{
                        label: 'Frecuencia de números',
                        data: Array(37).fill(0),
                        backgroundColor: 'rgba(0, 247, 255, 0.7)',
                        borderColor: 'rgba(0, 247, 255, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    }
                }
            });
        }
        
        // Actualizar gráfico
        function updateChart() {
            if (!frequencyChart) return;
            
            const counts = Array(37).fill(0);
            appData.history.forEach(num => {
                if (num >= 0 && num <= 36) counts[num]++;
            });
            
            frequencyChart.data.datasets[0].data = counts;
            frequencyChart.update();
        }
    </script>
</body>
</html>